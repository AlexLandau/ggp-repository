<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:param name="width" select="400"/><xsl:param name="height" select="400"/><xsl:template name="main" match="/">  <div>    <!-- Set Style -->    <style type="text/css" media="all">      div#board {        width:  <xsl:value-of select="$width"/>px;        height: <xsl:value-of select="$height"/>px;              }      img.board {        width:  <xsl:value-of select="$height * 0.546"/>px;        height: <xsl:value-of select="$height"/>px;            }      td.cell {        width:  <xsl:value-of select="$width * 0.125"/>px;        height: <xsl:value-of select="$height * 0.125"/>px;        border: 2px solid #000;        border-style: hidden;        moz-border-radius: 45px;        border-radius: 45px;        background-color: transparent;        align: center;        valign: middle;      }      table.board {        background-color: #000000;      }      img.piece {        width: <xsl:value-of select="$width * 0.125 * 0.9"/>px;        height: <xsl:value-of select="$height * 0.125 * 0.9"/>px;              }    </style>         <div id="board" style="position:relative">      <!-- Draw Background -->      <center>      <img class="board" src="&ROOT;/resources/images/zhadu/board.png"/>      </center>			       <xsl:call-template name="cells">        <xsl:with-param name="max_index" select="32"/>      </xsl:call-template>    </div>  </div>  </xsl:template><xsl:template name="cell" match="state/fact">  <xsl:param name="index" select="1"/>   <xsl:variable name="cell_id">    <xsl:choose>      <xsl:when test="$index=1">  "a"</xsl:when>      <xsl:when test="$index=2">  "b"</xsl:when>      <xsl:when test="$index=3">  "c"</xsl:when>      <xsl:when test="$index=4">  "d"</xsl:when>      <xsl:when test="$index=5">  "e"</xsl:when>      <xsl:when test="$index=6">  "f"</xsl:when>      <xsl:when test="$index=7">  "g"</xsl:when>      <xsl:when test="$index=8">  "h"</xsl:when>      <xsl:when test="$index=9"> "a1"</xsl:when>      <xsl:when test="$index=10">"b1"</xsl:when>      <xsl:when test="$index=11">"c1"</xsl:when>      <xsl:when test="$index=12">"d1"</xsl:when>      <xsl:when test="$index=13">"e1"</xsl:when>      <xsl:when test="$index=14">"f1"</xsl:when>      <xsl:when test="$index=15">"g1"</xsl:when>      <xsl:when test="$index=16">"h1"</xsl:when>      <xsl:when test="$index=17">"a2"</xsl:when>      <xsl:when test="$index=18">"b2"</xsl:when>      <xsl:when test="$index=19">"c2"</xsl:when>      <xsl:when test="$index=20">"d2"</xsl:when>      <xsl:when test="$index=21">"e2"</xsl:when>      <xsl:when test="$index=22">"f2"</xsl:when>      <xsl:when test="$index=23">"g2"</xsl:when>      <xsl:when test="$index=24">"h2"</xsl:when>      <xsl:when test="$index=25">"a3"</xsl:when>      <xsl:when test="$index=26">"b3"</xsl:when>      <xsl:when test="$index=27">"c3"</xsl:when>      <xsl:when test="$index=28">"d3"</xsl:when>      <xsl:when test="$index=29">"e3"</xsl:when>      <xsl:when test="$index=30">"f3"</xsl:when>      <xsl:when test="$index=31">"g3"</xsl:when>      <xsl:when test="$index=32">"h3"</xsl:when>    </xsl:choose>  </xsl:variable>  <xsl:variable name="xfactor">    <xsl:choose>      <xsl:when test="$index=1">  0.0100 </xsl:when>      <xsl:when test="$index=2">  0.0425 </xsl:when>      <xsl:when test="$index=3">  0.0750 </xsl:when>      <xsl:when test="$index=4">  0.1000 </xsl:when>      <xsl:when test="$index=5">  0.1325 </xsl:when>      <xsl:when test="$index=6">  0.1625 </xsl:when>      <xsl:when test="$index=7">  0.1925 </xsl:when>      <xsl:when test="$index=8">  0.2225 </xsl:when>      <xsl:when test="$index=9">  0.2500 </xsl:when>      <xsl:when test="$index=10"> 0.2800 </xsl:when>      <xsl:when test="$index=11"> 0.3125 </xsl:when>      <xsl:when test="$index=12"> 0.3425 </xsl:when>      <xsl:when test="$index=13"> 0.3725 </xsl:when>      <xsl:when test="$index=14"> 0.4025 </xsl:when>      <xsl:when test="$index=15"> 0.4325 </xsl:when>      <xsl:when test="$index=16"> 0.4625 </xsl:when>      <xsl:when test="$index=17"> 0.4925 </xsl:when>      <xsl:when test="$index=18"> 0.5225 </xsl:when>      <xsl:when test="$index=19"> 0.5525 </xsl:when>      <xsl:when test="$index=20"> 0.5825 </xsl:when>      <xsl:when test="$index=21"> 0.6125 </xsl:when>      <xsl:when test="$index=22"> 0.6425 </xsl:when>      <xsl:when test="$index=23"> 0.6725 </xsl:when>      <xsl:when test="$index=24"> 0.7025 </xsl:when>      <xsl:when test="$index=25"> 0.7325 </xsl:when>      <xsl:when test="$index=26"> 0.7625 </xsl:when>      <xsl:when test="$index=27"> 0.7925 </xsl:when>      <xsl:when test="$index=28"> 0.8225 </xsl:when>      <xsl:when test="$index=29"> 0.8525 </xsl:when>      <xsl:when test="$index=30"> 0.8825 </xsl:when>      <xsl:when test="$index=31"> 0.9125 </xsl:when>      <xsl:when test="$index=32"> 0.9425 </xsl:when>    </xsl:choose>  </xsl:variable>  <xsl:variable name="yfactor">    <xsl:choose>      <xsl:when test="$index=1">  0.0100 </xsl:when>      <xsl:when test="$index=2">  0.9725 </xsl:when>      <xsl:when test="$index=3">  0.0450 </xsl:when>      <xsl:when test="$index=4">  0.9400 </xsl:when>      <xsl:when test="$index=5">  0.0725 </xsl:when>      <xsl:when test="$index=6">  0.9125 </xsl:when>      <xsl:when test="$index=7">  0.1025 </xsl:when>      <xsl:when test="$index=8">  0.8825 </xsl:when>      <xsl:when test="$index=9">  0.1300 </xsl:when>      <xsl:when test="$index=10"> 0.8500 </xsl:when>      <xsl:when test="$index=11"> 0.1725 </xsl:when>      <xsl:when test="$index=12"> 0.8225 </xsl:when>      <xsl:when test="$index=13"> 0.2025 </xsl:when>      <xsl:when test="$index=14"> 0.7925 </xsl:when>      <xsl:when test="$index=15"> 0.2425 </xsl:when>      <xsl:when test="$index=16"> 0.7525 </xsl:when>      <xsl:when test="$index=17"> 0.2725 </xsl:when>      <xsl:when test="$index=18"> 0.7225 </xsl:when>      <xsl:when test="$index=19"> 0.3025 </xsl:when>      <xsl:when test="$index=20"> 0.6925 </xsl:when>      <xsl:when test="$index=21"> 0.3325 </xsl:when>      <xsl:when test="$index=22"> 0.6625 </xsl:when>      <xsl:when test="$index=23"> 0.3625 </xsl:when>      <xsl:when test="$index=24"> 0.6325 </xsl:when>      <xsl:when test="$index=25"> 0.3925 </xsl:when>      <xsl:when test="$index=26"> 0.6025 </xsl:when>      <xsl:when test="$index=27"> 0.4225 </xsl:when>      <xsl:when test="$index=28"> 0.5725 </xsl:when>      <xsl:when test="$index=29"> 0.4525 </xsl:when>      <xsl:when test="$index=30"> 0.5425 </xsl:when>      <xsl:when test="$index=31"> 0.4825 </xsl:when>      <xsl:when test="$index=32"> 0.5125 </xsl:when>    </xsl:choose>  </xsl:variable>    <table>  <xsl:attribute name="style">    <xsl:value-of select="concat('position:absolute; left: ',$width * ($xfactor - 0.0625),'px; top: ',$height * ($yfactor - 0.05),'px')"/>		  </xsl:attribute>    <tr>  <td class="cell">  <xsl:attribute name="id">    <xsl:value-of select="'cell_'"/>    <xsl:value-of select="$cell_id"/>  </xsl:attribute>      <xsl:variable name="owner" select="//fact[relation='piece' and argument[2]=$index]/argument[0]"/>  <xsl:variable name="value" select="//fact[relation='piece' and argument[2]=$index]/argument[1]"/>    <center>    <xsl:if test="string-length($owner) > 0">      <img class="piece">      <xsl:attribute name="src">        <xsl:value-of select="concat('&ROOT;/resources/images/zhadu/stone_',$owner,'_',$value,'.png')"/>      </xsl:attribute>      </img>    </xsl:if>  </center>      </td>  </tr>  </table></xsl:template><xsl:template name="cells">  <xsl:param name="max_index" select="1"/>  <xsl:param name="index" select="1"/>    <xsl:call-template name="cell">    <xsl:with-param name="index" select="$index"/>  </xsl:call-template>  <xsl:if test="$index &lt; $max_index">    <xsl:call-template name="cells">      <xsl:with-param name="max_index" select="$max_index"/>      <xsl:with-param name="index" select="$index + 1"/>    </xsl:call-template>  </xsl:if></xsl:template></xsl:stylesheet>